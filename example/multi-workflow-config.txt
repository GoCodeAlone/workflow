# Multi-Workflow Architecture
#
# This diagram visualizes how multiple workflows (HTTP and messaging) work together

┌──────────────────────────────────────────────────────────────────┐
│                   Multi-Workflow Engine                          │
└───────────────────────────────┬──────────────────────────────────┘
                                │
┌───────────────────────────────┼──────────────────────────────────┐
│                               │                                  │
│  ┌─────────────────────────────────────────┐                     │
│  │             HTTP Workflow               │                     │
│  │                                         │                     │
│  │  ┌───────────┐          ┌───────────┐   │                     │
│  │  │           │          │           │   │                     │
│  │  │  HTTP     │          │  API      │   │    ┌──────────────┐ │
│  │  │  Server   │──┬─────► │  Router   │───┼───►│  Health      │ │
│  │  │  (:8080)  │  │       │           │   │    │  Handler     │ │
│  │  │           │  │       │           │   │    └──────────────┘ │
│  │  └───────────┘  │       └───────────┘   │                     │
│  │                 │             │         │                     │
│  └─────────────────┼─────────────┼─────────┘                     │
│                    │             │                               │
│                    │             │   ┌───────────┐               │
│                    │             │   │           │               │
│                    │             │   │  Auth     │               │
│                    │             │   │  Middleware│               │
│                    │             │   │           │               │
│                    │             │   └───────────┘               │
│                    │             │         │                     │
│                    │             │         ▼                     │
│                    │             │   ┌───────────┐               │
│                    │             ├──►│  Users    │               │
│                    │             │   │  API      │──┬────────────┼──►
│                    │             │   │           │  │            │  User Events
│                    │             │   └───────────┘  │            │
│                    │             │                  │            │
│                    │             │   ┌───────────┐  │            │
│                    │             └──►│  Products │  │            │
│                    │                 │  API      │  │            │
│                    └────────────────►│           │  │            │
│                                      └───────────┘  │            │
│                                                     │            │
│                                                     │            │
│  ┌──────────────────────────────────────────────────┘            │
│  │                                                               │
│  │                     Messaging Workflow                        │
│  │                                                               │
│  │   ┌───────────┐     ┌───────────┐     ┌───────────┐          │
│  │   │           │     │           │     │           │          │
│  │   │ Message   │     │  User     │     │  Audit    │          │
│  │   │ Broker    │────►│  Event    │     │  Log      │          │
│  │   │           │     │  Handler  │     │  Handler  │          │
│  │   │           │     │           │     │           │          │
│  │   └───────────┘     └───────────┘     └───────────┘          │
│  │         │                                   ▲                │
│  │         │                                   │                │
│  │         └───────────────────────────────────┘                │
│  │                                                               │
└──┴───────────────────────────────────────────────────────────────┘

# Request Flow
#
# This shows how a request flows through the system

┌─────────┐     ┌────────────┐     ┌──────────────┐     ┌────────┐
│ Client  │────►│ HTTP Server│────►│ Auth         │────►│ API    │
│ Request │     │            │     │ Middleware   │     │ Handler│
└─────────┘     └────────────┘     └──────────────┘     └────┬───┘
                                                             │
                                                             ▼
                                                      ┌────────────┐
                                                      │ Message    │
                                                      │ Broker     │
                                                      └─────┬──────┘
                                                            │
                                            ┌───────────────┴────────────────┐
                                            │                                │
                                            ▼                                ▼
                                     ┌────────────┐                   ┌────────────┐
                                     │ User Event │                   │ Audit Log  │
                                     │ Handler    │                   │ Handler    │
                                     └────────────┘                   └────────────┘